define(function(t){return t("jquery.form")($),function(t){!function(t){"use strict";t.fn.candyAjaxSubmit=function(e){e=e||{};var n,s=this,r={url:s.attr("url")||window.location.href||"",type:s.attr("url")||"POST",dataType:"json",data:null,loading:!0,target:null,submitButton:null,sendingLabel:"发送中",successLabel:"发送成功",errorLabel:"发送失败",beforeSubmit:function(){},success:function(){},error:function(){}},i=t.extend({},r,e);n="Object"==typeof i.submitButton?i.submitButton:"string"==typeof i.submitButton?t("#"+i.submitButton):s.find("*[type=submit]");var a=t("#statusTip");a.length||(s.after('<div id="statusTip" class="display:none"><img src="/static/images/loading.gif"></div>'),a=t("#statusTip"));var o={beforeSubmit:function(){i.beforeSubmit(),a.removeClass("alert alert-success alert-error").html('<img src="/static/images/loading.gif">').show(),u(n,i.sendingLabel,!0)},success:function(t){"json"!=i.dataType||"undefined"!=typeof t.error&&""!=t.error||(setTimeout(function(){a.hide().html("内容发布成功!").addClass("alert alert-success").fadeIn(500),u(n,i.successLabel,!1),i.success(t),s[0].reset()},500),setTimeout(function(){a.fadeOut(300)},2e3))},error:function(t){u(n,i.errorLabel,!1),a.hide().html("很抱歉,系统超时或出错，请与管理员联系!").addClass("alert alert-error").fadeIn(500),i.error(t)}},u=function(t,e,n){return"INPUT"==t[0].tagName?t.attr("value",e):t.html(e),t.attr("disabled",n)};s.ajaxSubmit(t.extend({},i,o))},t.fn.candyForm=function(t){if(this.length){var e=this;e.bind("submit",function(n){n.preventDefault(),e.candyAjaxSubmit(t)})}};var e=function(){console.log(this.attr("class"))};e.prototype.send=function(){console.log("test send")},t.fn.testForm=e}(t)}});